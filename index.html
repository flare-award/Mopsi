<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>üê∂ Pug Empire</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #FFD700;
            --success: #4CAF50;
            --danger: #FF6B6B;
            --warning: #FFA500;
            --dark: #2c3e50;
            --light: #f8f9fa;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        html {
            font-size: 16px;
        }
        
        @media (max-width: 768px) {
            html {
                font-size: 14px;
            }
        }
        
        @media (max-width: 480px) {
            html {
                font-size: 12px;
            }
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            overflow: hidden;
            user-select: none;
            min-height: 100vh;
            height: auto;
            transition: background 0.3s ease, color 0.3s ease;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }
        
        /* –¢–µ–º–∞ Modern */
        body.theme-modern {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        body.theme-modern .stat-card {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(20px);
        }
        
        /* –¢–µ–º–∞ Classic (Windows XP) */
        body.theme-classic {
            background: linear-gradient(135deg, #245edc 0%, #3a7bd5 100%);
            font-family: 'Tahoma', 'Verdana', sans-serif;
        }
        
        body.theme-classic .nav-btn {
            background: linear-gradient(to bottom, #f0f0f0, #d0d0d0);
            color: #000;
            border: 2px outset #c0c0c0;
            font-weight: bold;
        }
        
        body.theme-classic .stat-card {
            background: rgba(255,255,255,0.9);
            color: #000;
            border: 2px inset #c0c0c0;
        }
        
        /* –¢–µ–º–∞ New Year */
        body.theme-newyear {
            background: linear-gradient(135deg, #1a2980 0%, #26d0ce 100%);
            position: relative;
            overflow: hidden;
        }
        
        body.theme-newyear::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(white 2%, transparent 3%),
                radial-gradient(white 2%, transparent 3%);
            background-size: 50px 50px;
            background-position: 0 0, 25px 25px;
            opacity: 0.3;
            animation: snowFall 10s linear infinite;
            pointer-events: none;
            z-index: 1;
        }
        
        @keyframes snowFall {
            0% { background-position: 0 0, 25px 25px; }
            100% { background-position: 0 500px, 25px 525px; }
        }
        
        body.theme-newyear .nav-btn {
            background: linear-gradient(135deg, #ff3366 0%, #ff9966 100%);
            position: relative;
            overflow: hidden;
        }
        
        body.theme-newyear .nav-btn::after {
            content: '‚ùÑÔ∏è';
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 12px;
            opacity: 0.8;
        }
        
        body.theme-newyear .pug-image {
            border: 8px solid #ff3366;
            background: linear-gradient(135deg, #ff3366, #ff9966);
        }
        
        /* –¢–µ–º–∞ Halloween */
        body.theme-halloween {
            background: linear-gradient(135deg, #000428 0%, #004e92 100%);
            position: relative;
            overflow: hidden;
        }
        
        body.theme-halloween .pumpkin-tracker {
            position: fixed;
            width: 60px;
            height: 60px;
            background: #ff6600;
            border-radius: 50% 50% 40% 40%;
            z-index: 1000;
            pointer-events: none;
            transition: transform 0.1s ease;
            box-shadow: 0 0 20px rgba(255, 102, 0, 0.5);
            opacity: 0.8;
        }
        
        body.theme-halloween .pumpkin-tracker::before,
        body.theme-halloween .pumpkin-tracker::after {
            content: '';
            position: absolute;
            width: 10px;
            height: 15px;
            background: #000;
            border-radius: 50%;
            top: 20px;
        }
        
        body.theme-halloween .pumpkin-tracker::before {
            left: 15px;
        }
        
        body.theme-halloween .pumpkin-tracker::after {
            right: 15px;
        }
        
        body.theme-halloween .bat {
            position: fixed;
            font-size: 30px;
            animation: flyBat 15s linear infinite;
            opacity: 0.3;
            z-index: 1;
        }
        
        @keyframes flyBat {
            0% { transform: translate(-100px, -100px) rotate(0deg); }
            100% { transform: translate(calc(100vw + 100px), calc(100vh + 100px)) rotate(360deg); }
        }
        
        body.theme-halloween .nav-btn {
            background: linear-gradient(135deg, #ff6600 0%, #993300 100%);
            border: 2px solid #ffcc00;
        }
        
        body.theme-halloween .pug-image {
            border: 8px solid #ff6600;
            background: linear-gradient(135deg, #ff6600, #993300);
        }
        
        /* –°—Ç–∏–ª–∏ —Å–∫–∏–Ω–æ–≤ */
        .skin-bonus {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--accent);
            color: #000;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 100;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .game-container {
            width: 100%;
            min-height: 100vh;
            padding: max(1rem, env(safe-area-inset-top)) max(1rem, env(safe-area-inset-right)) max(1rem, env(safe-area-inset-bottom)) max(1rem, env(safe-area-inset-left));
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 2;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .stats {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            flex: 1;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.15);
            padding: 0.5rem 0.75rem;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            min-width: 60px;
            max-width: 120px;
            text-align: center;
            transition: transform 0.2s ease, background 0.3s ease;
            flex: 1;
        }
        
        .main-game {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            padding: 1rem;
        }
        
        .pug-container {
            position: relative;
            width: min(280px, 70vw);
            height: min(280px, 70vw);
            margin: 0 auto;
        }
        
        .pug-image {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(60px, 15vw, 120px);
            cursor: pointer;
            transition: all 0.1s ease;
            border: 8px solid #FF8C00;
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.3),
                inset 0 10px 20px rgba(255,255,255,0.3);
            user-select: none;
            animation: float 3s ease-in-out infinite;
        }
        
        .bottom-nav {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        @media (max-width: 480px) {
            .bottom-nav {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .nav-btn {
            background: rgba(255,255,255,0.15);
            border: none;
            padding: 0.75rem 0.5rem;
            border-radius: 15px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            font-size: clamp(12px, 3vw, 14px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }
        
        /* –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–ø–æ–≤ */
        .taps-display {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.6);
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 14px;
            z-index: 100;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        @media (max-width: 768px) {
            .taps-display {
                position: static;
                margin-bottom: 10px;
                background: rgba(0,0,0,0.4);
            }
        }
        
        /* –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω */
        @media (orientation: landscape) and (max-height: 600px) {
            .header {
                margin-bottom: 0.5rem;
            }
            
            .main-game {
                flex-direction: row;
                gap: 1rem;
            }
            
            .pug-container {
                width: min(200px, 40vh);
                height: min(200px, 40vh);
            }
            
            .energy-container {
                width: 200px;
            }
        }
        
        /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 320px) {
            .stat-card {
                min-width: 50px;
                padding: 0.4rem 0.5rem;
            }
            
            .stat-value {
                font-size: 14px;
            }
            
            .nav-btn span {
                font-size: 10px;
            }
        }
        
        /* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º–Ω–æ–π —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
        @media (prefers-color-scheme: dark) {
            body:not([class*="theme-"]) {
                background: linear-gradient(135deg, var(--dark) 0%, #34495e 100%);
            }
        }
        
        /* –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Å–Ω–µ–≥ –¥–ª—è –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–π —Ç–µ–º—ã */
        .snowflake {
            position: fixed;
            color: white;
            font-size: 1em;
            animation: fall linear infinite;
            pointer-events: none;
            z-index: 1;
            opacity: 0.8;
        }
        
        @keyframes fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(calc(100vh + 100px)) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –±–æ–Ω—É—Å–æ–≤ —Å–∫–∏–Ω–æ–≤ */
        .skin-theme-default {
            --skin-primary: #667eea;
            --skin-secondary: #764ba2;
            --skin-accent: #FFD700;
        }
        
        .skin-theme-advanced {
            --skin-primary: #4CAF50;
            --skin-secondary: #2E7D32;
            --skin-accent: #00E676;
        }
        
        .skin-theme-fire {
            --skin-primary: #FF5722;
            --skin-secondary: #FF9800;
            --skin-accent: #FFC107;
        }
        
        .skin-theme-diamond {
            --skin-primary: #00BCD4;
            --skin-secondary: #0097A7;
            --skin-accent: #B2EBF2;
        }
        
        /* –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º —Å–∫–∏–Ω–æ–≤ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞ —Å–µ–∑–æ–Ω–Ω–∞—è —Ç–µ–º–∞ */
        body:not(.theme-newyear):not(.theme-halloween).skin-theme-active {
            background: linear-gradient(135deg, var(--skin-primary) 0%, var(--skin-secondary) 100%) !important;
        }
        
        body:not(.theme-newyear):not(.theme-halloween).skin-theme-active .pug-image {
            background: linear-gradient(135deg, var(--skin-accent), var(--skin-secondary));
            border-color: var(--skin-primary);
        }
        
        body:not(.theme-newyear):not(.theme-halloween).skin-theme-active .nav-btn {
            background: linear-gradient(135deg, var(--skin-primary), var(--skin-secondary));
        }
        
        /* –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç */
        .responsive-text {
            font-size: clamp(12px, 3vw, 16px);
            line-height: 1.4;
        }
        
        .responsive-title {
            font-size: clamp(16px, 5vw, 24px);
        }
        
        /* –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –¥–ª—è —Ç–µ–º */
        body, .nav-btn, .stat-card, .pug-image {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è UX */
        .sync-indicator {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .sync-indicator.syncing .sync-icon {
            animation: spin 1s linear infinite;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ */
        .icon-responsive {
            font-size: clamp(16px, 4vw, 24px);
        }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loading-overlay">
        <div class="spinner"></div>
        <div>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º...</div>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">–£—Å–ø–µ—à–Ω–æ!</span>
    </div>

    <div class="sync-indicator" id="sync-indicator">
        <i class="fas fa-sync-alt sync-icon"></i>
        <span>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...</span>
    </div>

    <div class="game-container">
        <div class="header">
            <div class="stats">
                <div class="stat-card">
                    <div>üíé</div>
                    <div class="stat-value" id="coins">0</div>
                </div>
                <div class="stat-card">
                    <div>üèÜ</div>
                    <div class="stat-value" id="level">1</div>
                </div>
                <div class="stat-card">
                    <div>üëä</div>
                    <div class="stat-value" id="per-tap">1</div>
                </div>
            </div>
            <div class="stat-card" onclick="showSkins()" style="cursor: pointer;">
                <div id="current-skin">üê∂</div>
                <div style="font-size: 0.75rem;">–°–∫–∏–Ω</div>
                <div class="skin-bonus" id="skin-bonus" style="display: none;">+0%</div>
            </div>
        </div>
        
        <div class="main-game">
            <div class="taps-display">
                üëä –í—Å–µ–≥–æ —Ç–∞–ø–æ–≤: <span id="total-taps-count">0</span>
            </div>
            
            <div class="energy-container" style="width: 100%; max-width: 300px;">
                <div class="energy-bar">
                    <div class="energy-fill" id="energy-fill" style="width: 100%;"></div>
                </div>
                <div style="text-align: center; font-size: 0.875rem;">
                    ‚ö° –≠–Ω–µ—Ä–≥–∏—è: <span id="energy">100</span>/<span id="max-energy">100</span>
                    <br>
                    <small>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ: 1/<span id="regen-speed">10</span>—Å</small>
                </div>
            </div>
            
            <div class="pug-container">
                <div class="pug-image" id="tap-area">
                    üê∂
                </div>
            </div>
            
            <div style="text-align: center;">
                <div class="responsive-title" style="font-weight: bold; margin-bottom: 0.25rem;" id="skin-name">–ù–∞—á–∏–Ω–∞—é—â–∏–π –º–æ–ø—Å</div>
                <div class="responsive-text" style="opacity: 0.8;">–í—Å–µ–≥–æ —Ç–∞–ø–æ–≤: <span id="total-taps-display">0</span></div>
                <div class="responsive-text" style="opacity: 0.6; margin-top: 0.25rem;" id="next-skin">–°–ª–µ–¥—É—é—â–∏–π —Å–∫–∏–Ω: 1,000 —Ç–∞–ø–æ–≤</div>
            </div>
        </div>
        
        <div class="bottom-nav">
            <button class="nav-btn upgrade-btn" onclick="showUpgrades()">
                <i class="fas fa-tools icon-responsive"></i>
                <span>–ü—Ä–æ–∫–∞—á–∫–∞</span>
            </button>
            <button class="nav-btn withdraw-btn" onclick="showWithdraw()">
                <i class="fas fa-gem icon-responsive"></i>
                <span>–í—ã–≤–æ–¥</span>
            </button>
            <button class="nav-btn" onclick="showLeaderboard()">
                <i class="fas fa-trophy icon-responsive"></i>
                <span>–¢–æ–ø</span>
            </button>
            <button class="nav-btn" onclick="showClans()">
                <i class="fas fa-users icon-responsive"></i>
                <span>–ö–ª–∞–Ω—ã</span>
            </button>
            <button class="nav-btn" onclick="showReferrals()">
                <i class="fas fa-user-plus icon-responsive"></i>
                <span>–†–µ—Ñ–µ—Ä–∞–ª—ã</span>
            </button>
            <button class="nav-btn" onclick="showSettings()">
                <i class="fas fa-cog icon-responsive"></i>
                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </button>
        </div>
    </div>
    
    <!-- –ü–æ–ø–∞–ø –±–æ–Ω—É—Å–æ–≤ -->
    <div class="bonus-popup" id="bonus-popup">
        <div class="popup-title" id="popup-title">üéâ –ë–û–ù–£–°!</div>
        <div id="popup-message" style="font-size: 1.125rem; margin-bottom: 1.25rem;">+10 –º–æ–Ω–µ—Ç!</div>
        <button class="btn btn-accent" onclick="closePopup()" style="width: 100%;">
            <i class="fas fa-check"></i> OK
        </button>
    </div>
    
    <!-- –ú–µ–Ω—é –ø—Ä–æ–∫–∞—á–∫–∏ -->
    <div class="menu-overlay" id="upgrades-menu">
        <div class="menu-content">
            <div class="menu-header">
                <h2><i class="fas fa-tools"></i> –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–∫–∞—á–∫–∏</h2>
                <button class="close-btn" onclick="hideUpgrades()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="upgrades-list">
                <!-- –£–ª—É—á—à–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
    </div>
    
    <!-- –ú–µ–Ω—é –≤—ã–≤–æ–¥–∞ -->
    <div class="menu-overlay" id="withdraw-menu">
        <div class="menu-content">
            <div class="menu-header">
                <h2><i class="fas fa-gem"></i> –í—ã–≤–æ–¥ –º–æ–Ω–µ—Ç</h2>
                <button class="close-btn" onclick="hideWithdraw()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div style="margin-bottom: 1.25rem;">
                <div class="stat-card" style="margin-bottom: 0.9375rem;">
                    <div>üí∞ –ë–∞–ª–∞–Ω—Å</div>
                    <div class="stat-value" id="withdraw-balance">0</div>
                </div>
                
                <!-- –ö—É—Ä—Å—ã –æ–±–º–µ–Ω–∞ -->
                <div class="withdraw-rates" id="withdraw-rates">
                    <!-- –ö—É—Ä—Å—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
                
                <div style="opacity: 0.8; font-size: 0.875rem; margin-bottom: 0.9375rem; text-align: center;">
                    üí° –ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ –º–µ—Ç–æ–¥ –≤—ã–≤–æ–¥–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫—É—Ä—Å–∞
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" onclick="switchWithdrawTab('crypto')">–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã</div>
                <div class="tab" onclick="switchWithdrawTab('ewallet')">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –∫–æ—à–µ–ª—å–∫–∏</div>
                <div class="tab" onclick="switchWithdrawTab('game')">–ò–≥—Ä–æ–≤—ã–µ –≤–∞–ª—é—Ç—ã</div>
            </div>
            
            <div class="tab-content active" id="crypto-tab">
                <div class="withdraw-form">
                    <div class="form-group">
                        <label class="form-label" for="crypto-method">–ú–µ—Ç–æ–¥ –≤—ã–≤–æ–¥–∞:</label>
                        <select class="form-select" id="crypto-method" onchange="updateMinAmount('crypto')">
                            <option value="ton">‚ö° TON (The Open Network)</option>
                            <option value="trx">üîó TRX (TRON)</option>
                            <option value="bnb">üü° BNB (Binance Coin)</option>
                            <option value="usdt">üíµ USDT (TRC-20)</option>
                        </select>
                        <div class="min-amount-info" id="crypto-min-amount">
                            –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞: 200,000 –º–æ–Ω–µ—Ç (10 TON)
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="crypto-amount">–°—É–º–º–∞ –≤—ã–≤–æ–¥–∞ (–º–æ–Ω–µ—Ç—ã):</label>
                        <input type="number" class="form-input" id="crypto-amount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="200000">
                        <div class="exchange-rate-display" id="crypto-exchange">
                            0 –º–æ–Ω–µ—Ç = 0.00 TON
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="crypto-address">–ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞:</label>
                        <input type="text" class="form-input" id="crypto-address" placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ –∫–æ—à–µ–ª—å–∫–∞">
                    </div>
                    
                    <button class="btn btn-success" style="width: 100%;" onclick="submitWithdraw('crypto')">
                        <i class="fas fa-paper-plane"></i> –í—ã–≤–µ—Å—Ç–∏
                    </button>
                </div>
            </div>
            
            <div class="tab-content" id="ewallet-tab">
                <div class="withdraw-form">
                    <div class="form-group">
                        <label class="form-label" for="ewallet-method">–ú–µ—Ç–æ–¥ –≤—ã–≤–æ–¥–∞:</label>
                        <select class="form-select" id="ewallet-method" onchange="updateMinAmount('ewallet')">
                            <option value="qiwi">ü•ù Qiwi</option>
                            <option value="yoomoney">üí≥ –ÆMoney</option>
                            <option value="webmoney">üï∏Ô∏è WebMoney</option>
                        </select>
                        <div class="min-amount-info" id="ewallet-min-amount">
                            –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞: 200,000 –º–æ–Ω–µ—Ç (5 USD/RUB)
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="ewallet-amount">–°—É–º–º–∞ –≤—ã–≤–æ–¥–∞ (–º–æ–Ω–µ—Ç—ã):</label>
                        <input type="number" class="form-input" id="ewallet-amount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="200000">
                        <div class="exchange-rate-display" id="ewallet-exchange">
                            0 –º–æ–Ω–µ—Ç = 0.00 USD
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="ewallet-account">–ù–æ–º–µ—Ä —Å—á–µ—Ç–∞/–∫–æ—à–µ–ª—å–∫–∞:</label>
                        <input type="text" class="form-input" id="ewallet-account" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –≤–∞—à–µ–≥–æ –∫–æ—à–µ–ª—å–∫–∞">
                    </div>
                    
                    <button class="btn btn-success" style="width: 100%;" onclick="submitWithdraw('ewallet')">
                        <i class="fas fa-paper-plane"></i> –í—ã–≤–µ—Å—Ç–∏
                    </button>
                </div>
            </div>
            
            <div class="tab-content" id="game-tab">
                <div class="withdraw-form">
                    <div class="form-group">
                        <label class="form-label" for="game-method">–ú–µ—Ç–æ–¥ –≤—ã–≤–æ–¥–∞:</label>
                        <select class="form-select" id="game-method" onchange="updateMinAmount('game')">
                            <option value="valorant">üéØ Valorant Points</option>
                            <option value="steam">üéØ Steam Funds</option>
                            <option value="robux">üéÆ Robux</option>
                        </select>
                        <div class="min-amount-info" id="game-min-amount">
                            –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞: 1,000,000 –º–æ–Ω–µ—Ç (10 Robux)
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="game-amount">–°—É–º–º–∞ –≤—ã–≤–æ–¥–∞ (–º–æ–Ω–µ—Ç—ã):</label>
                        <input type="number" class="form-input" id="game-amount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="1000000">
                        <div class="exchange-rate-display" id="game-exchange">
                            0 –º–æ–Ω–µ—Ç = 0.00 Robux
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="game-username">–ò–≥—Ä–æ–≤–æ–π –Ω–∏–∫–Ω–µ–π–º/ID:</label>
                        <input type="text" class="form-input" id="game-username" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∏–≥—Ä–æ–≤–æ–π –Ω–∏–∫–Ω–µ–π–º –∏–ª–∏ ID">
                    </div>
                    
                    <button class="btn btn-success" style="width: 100%;" onclick="submitWithdraw('game')">
                        <i class="fas fa-paper-plane"></i> –í—ã–≤–µ—Å—Ç–∏
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–µ–Ω—é —Å–∫–∏–Ω–æ–≤ -->
    <div class="menu-overlay" id="skins-menu">
        <div class="menu-content">
            <div class="menu-header">
                <h2><i class="fas fa-palette"></i> –ö–æ–ª–ª–µ–∫—Ü–∏—è –º–æ–ø—Å–æ–≤</h2>
                <button class="close-btn" onclick="hideSkins()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div style="margin-bottom: 1.25rem;">
                <div class="stat-card">
                    <div>üìä –í—Å–µ–≥–æ —Ç–∞–ø–æ–≤</div>
                    <div class="stat-value" id="total-taps">0</div>
                </div>
            </div>
            
            <div class="skin-grid" id="skins-grid">
                <!-- –°–∫–∏–Ω—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
    </div>
    
    <!-- –ú–µ–Ω—é –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ -->
    <div class="menu-overlay" id="leaderboard-menu">
        <div class="menu-content">
            <div class="menu-header">
                <h2><i class="fas fa-trophy"></i> –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h2>
                <button class="close-btn" onclick="hideLeaderboard()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="tabs">
                <div class="tab active" onclick="switchLeaderboardTab('players')">–ò–≥—Ä–æ–∫–∏</div>
                <div class="tab" onclick="switchLeaderboardTab('clans')">–ö–ª–∞–Ω—ã</div>
                <div class="tab" onclick="switchLeaderboardTab('taps')">–¢–∞–ø—ã</div>
            </div>
            
            <div class="tab-content active" id="players-tab">
                <div class="leaderboard-list" id="leaderboard-list">
                    <!-- –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
            
            <div class="tab-content" id="clans-tab">
                <div class="leaderboard-list" id="clans-leaderboard">
                    <!-- –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –∫–ª–∞–Ω–æ–≤ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
            
            <div class="tab-content" id="taps-tab">
                <div class="leaderboard-list" id="taps-leaderboard">
                    <!-- –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –ø–æ —Ç–∞–ø–∞–º –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
            
            <div style="margin-top: 1.25rem; text-align: center; opacity: 0.8; font-size: 0.75rem;">
                –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
            </div>
        </div>
    </div>
    
    <!-- –ú–µ–Ω—é –∫–ª–∞–Ω–æ–≤ -->
    <div class="menu-overlay" id="clans-menu">
        <div class="menu-content">
            <div class="menu-header">
                <h2><i class="fas fa-users"></i> –°–∏—Å—Ç–µ–º–∞ –∫–ª–∞–Ω–æ–≤</h2>
                <button class="close-btn" onclick="hideClans()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div style="margin-bottom: 1.25rem;">
                <div class="stat-card">
                    <div>üèÜ –í–∞—à –∫–ª–∞–Ω</div>
                    <div class="stat-value" id="user-clan">–ù–µ –≤ –∫–ª–∞–Ω–µ</div>
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" onclick="switchClanTab('list')">–í—Å–µ –∫–ª–∞–Ω—ã</div>
                <div class="tab" onclick="switchClanTab('create')">–°–æ–∑–¥–∞—Ç—å –∫–ª–∞–Ω</div>
                <div class="tab" onclick="switchClanTab('my')">–ú–æ–π –∫–ª–∞–Ω</div>
            </div>
            
            <div class="tab-content active" id="clan-list-tab">
                <div id="clans-list">
                    <!-- –ö–ª–∞–Ω—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
            
            <div class="tab-content" id="clan-create-tab">
                <div class="clan-form">
                    <div class="form-group">
                        <label class="form-label" for="clan-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞:</label>
                        <input type="text" class="form-input" id="clan-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞" maxlength="20">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="clan-description">–û–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∞–Ω–∞:</label>
                        <textarea class="form-input" id="clan-description" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∞–Ω–∞" rows="3" maxlength="100"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="clan-channel">–°—Å—ã–ª–∫–∞ –Ω–∞ Telegram –∫–∞–Ω–∞–ª (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
                        <input type="url" class="form-input" id="clan-channel" placeholder="https://t.me/your_channel" required>
                        <small style="font-size: 0.75rem; opacity: 0.8;">–í—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –∫–∞–Ω–∞–ª–∞</small>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.1); padding: 0.9375rem; border-radius: 10px; margin-bottom: 0.9375rem;">
                        <div style="font-weight: bold; margin-bottom: 0.3125rem;">–°—Ç–æ–∏–º–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è: 1000 –º–æ–Ω–µ—Ç</div>
                        <div style="font-size: 0.75rem; opacity: 0.8;">–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã —Å—Ç–∞–Ω–µ—Ç–µ –ª–∏–¥–µ—Ä–æ–º –∫–ª–∞–Ω–∞</div>
                    </div>
                    
                    <button class="btn btn-success" style="width: 100%;" onclick="createClan()">
                        <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –∫–ª–∞–Ω
                    </button>
                </div>
            </div>
            
            <div class="tab-content" id="clan-my-tab">
                <div id="my-clan-info">
                    <div style="text-align: center; padding: 1.25rem; opacity: 0.7;">
                        <i class="fas fa-users" style="font-size: 3rem; margin-bottom: 0.9375rem;"></i>
                        <div>–í—ã –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ –∫–ª–∞–Ω–µ</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–µ–Ω—é —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ -->
    <div class="menu-overlay" id="referrals-menu">
        <div class="menu-content">
            <div class="menu-header">
                <h2><i class="fas fa-user-plus"></i> –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
                <button class="close-btn" onclick="hideReferrals()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div style="text-align: center; margin-bottom: 1.25rem;">
                <div style="font-size: 1rem; margin-bottom: 0.625rem;">–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã!</div>
                <div class="referral-code" id="referral-code">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                <button class="btn btn-accent" style="width: 100%; margin-top: 0.625rem;" onclick="copyReferralCode()">
                    <i class="fas fa-copy"></i> –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
                </button>
            </div>
            
            <div class="referral-stats">
                <div class="stat-card">
                    <div>üë• –ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ</div>
                    <div class="stat-value" id="referrals-count">0</div>
                </div>
                <div class="stat-card">
                    <div>üíé –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
                    <div class="stat-value" id="referrals-earned">0</div>
                </div>
            </div>
            
            <div class="referral-bonuses">
                <strong>üéÅ –ë–æ–Ω—É—Å—ã –∑–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤</strong>
                <div style="font-size: 0.875rem; margin-top: 0.625rem;">
                    ‚Ä¢ <strong>500 –º–æ–Ω–µ—Ç</strong> –∑–∞ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –¥—Ä—É–≥–∞<br>
                    ‚Ä¢ <strong>+1 –∫ —Å–∏–ª–µ —Ç–∞–ø–∞</strong> –∑–∞ –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞<br>
                    ‚Ä¢ <strong>–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —Å–∫–∏–Ω—ã</strong> –∑–∞ 10+ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤<br>
                    ‚Ä¢ <strong>–ë–æ–Ω—É—Å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</strong> –∑–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
                </div>
                
                <div style="margin-top: 0.9375rem; padding-top: 0.9375rem; border-top: 1px solid rgba(255,255,255,0.2);">
                    <strong>üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –±–æ–Ω—É—Å–æ–≤</strong>
                    <div style="margin-top: 0.625rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.3125rem;">
                            <span>5 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤</span>
                            <span style="color: var(--accent);">+2,500 –º–æ–Ω–µ—Ç</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="ref-progress-5" style="width: 0%;"></div>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.3125rem; margin-top: 0.9375rem;">
                            <span>10 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤</span>
                            <span style="color: var(--accent);">–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π —Å–∫–∏–Ω! üé≠</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="ref-progress-10" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div class="menu-overlay" id="settings-menu">
        <div class="menu-content">
            <div class="menu-header">
                <h2><i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <button class="close-btn" onclick="hideSettings()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="settings-item">
                <div>
                    <strong><i class="fas fa-volume-up"></i> –ó–≤—É–∫–∏</strong>
                    <div style="font-size: 0.75rem; opacity: 0.8;">–í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="sound-toggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="settings-item">
                <div>
                    <strong><i class="fas fa-vibrate"></i> –í–∏–±—Ä–∞—Ü–∏—è</strong>
                    <div style="font-size: 0.75rem; opacity: 0.8;">–í–∫–ª—é—á–∏—Ç—å —Ç–∞–∫—Ç–∏–ª—å–Ω—É—é –æ—Ç–¥–∞—á—É</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="vibration-toggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="settings-item">
                <div>
                    <strong><i class="fas fa-palette"></i> –°—Ç–∏–ª—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</strong>
                    <div style="font-size: 0.75rem; opacity: 0.8;">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</div>
                </div>
                <select class="form-select" id="interface-style" style="width: 150px;" onchange="changeInterfaceStyle(this.value)">
                    <option value="default">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π</option>
                    <option value="modern">–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π</option>
                    <option value="classic">–°—Ç–∞—Ä—ã–π (Classic)</option>
                    <option value="newyear">–ù–æ–≤–æ–≥–æ–¥–Ω–∏–π</option>
                    <option value="halloween">–•—ç–ª–ª–æ—É–∏–Ω</option>
                </select>
            </div>
            
            <div class="settings-item">
                <div>
                    <strong><i class="fas fa-moon"></i> –ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º</strong>
                    <div style="font-size: 0.75rem; opacity: 0.8;">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="dark-mode-toggle">
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="settings-item">
                <div>
                    <strong><i class="fas fa-bell"></i> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</strong>
                    <div style="font-size: 0.75rem; opacity: 0.8;">–ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="notifications-toggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <button class="btn btn-accent" style="width: 100%; margin-top: 1.25rem;" onclick="exportData()">
                <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
            </button>
            
            <button class="btn btn-danger" style="width: 100%; margin-top: 0.625rem;" onclick="resetProgress()">
                <i class="fas fa-trash"></i> –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
            </button>
            
            <div style="text-align: center; margin-top: 1.25rem; opacity: 0.7; font-size: 0.75rem;">
                –í–µ—Ä—Å–∏—è 3.1.0<br>
                Pug Empire ¬© 2024-2025
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è JSONBin.io
        const JSONBIN_API_KEY = "$2a$10$ZzqGSk9XmuCwrk6P2I0NNOjjfT/hS0tnyod4TaKGfz8pGZ/BIgHzO";
        const JSONBIN_BIN_ID = "692c283ad0ea881f40095800";
        const JSONBIN_URL = `https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}/latest`;
        const JSONBIN_UPDATE_URL = `https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`;

        // –ë–æ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        const BOT_USERNAME = "MelryBot";
        const BOT_NAME = "Melry";

        // –ö—É—Ä—Å—ã –æ–±–º–µ–Ω–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
        const EXCHANGE_RATES = {
            robux: { rate: 100000, min_amount: 10, currency: "Robux", emoji: "üéÆ", min_coins: 1000000 },
            steam: { rate: 50000, min_amount: 5, currency: "USD Steam", emoji: "üéØ", min_coins: 250000 },
            valorant: { rate: 80000, min_amount: 5, currency: "Valorant Points", emoji: "üéØ", min_coins: 400000 },
            ton: { rate: 20000, min_amount: 10, currency: "TON", emoji: "‚ö°", min_coins: 200000 },
            trx: { rate: 25000, min_amount: 10, currency: "TRX", emoji: "üîó", min_coins: 250000 },
            bnb: { rate: 30000, min_amount: 0.1, currency: "BNB", emoji: "üü°", min_coins: 3000 },
            usdt: { rate: 20000, min_amount: 10, currency: "USDT", emoji: "üíµ", min_coins: 200000 },
            qiwi: { rate: 40000, min_amount: 5, currency: "RUB Qiwi", emoji: "ü•ù", min_coins: 200000 },
            yoomoney: { rate: 40000, min_amount: 5, currency: "RUB –ÆMoney", emoji: "üí≥", min_coins: 200000 },
            webmoney: { rate: 45000, min_amount: 5, currency: "RUB WebMoney", emoji: "üï∏Ô∏è", min_coins: 225000 }
        };

        // –£–ª—É—á—à–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–∫–∏–Ω–æ–≤ —Å –±–æ–Ω—É—Å–∞–º–∏ –∏ —Ç–µ–º–∞–º–∏
        const PUG_SKINS = [
            {id: 1, name: "–ù–∞—á–∏–Ω–∞—é—â–∏–π –º–æ–ø—Å", taps_required: 0, emoji: "üê∂", bonus: { type: "tap_power", value: 0 }, theme: "default"},
            {id: 2, name: "–û–ø—ã—Ç–Ω—ã–π –º–æ–ø—Å", taps_required: 1000, emoji: "‚≠ê", bonus: { type: "tap_power", value: 0.1 }, theme: "advanced"},
            {id: 3, name: "–û–≥–Ω–µ–Ω–Ω—ã–π –º–æ–ø—Å", taps_required: 5000, emoji: "üî•", bonus: { type: "energy_regen", value: -1 }, theme: "fire"},
            {id: 4, name: "–ê–ª–º–∞–∑–Ω—ã–π –º–æ–ø—Å", taps_required: 15000, emoji: "üíé", bonus: { type: "critical_chance", value: 2 }, theme: "diamond"},
            {id: 5, name: "–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π –º–æ–ø—Å", taps_required: 30000, emoji: "üëë", bonus: { type: "coin_multiplier", value: 1.1 }, theme: "royal"},
            {id: 6, name: "–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –º–æ–ø—Å", taps_required: 60000, emoji: "üöÄ", bonus: { type: "energy_capacity", value: 20 }, theme: "space"},
            {id: 7, name: "–ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –º–æ–ø—Å", taps_required: 120000, emoji: "üåå", bonus: { type: "tap_power", value: 0.2 }, theme: "galaxy"},
            {id: 8, name: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –º–æ–ø—Å", taps_required: 250000, emoji: "üí´", bonus: { type: "critical_multiplier", value: 0.2 }, theme: "legendary"},
            {id: 9, name: "–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π –º–æ–ø—Å", taps_required: 500000, emoji: "üé≠", bonus: { type: "coin_multiplier", value: 1.2 }, theme: "mythical"},
            {id: 10, name: "–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º–æ–ø—Å", taps_required: 1000000, emoji: "üåü", bonus: { type: "all_stats", value: 0.1 }, theme: "divine"},
            {id: 11, name: "–í–µ—á–Ω—ã–π –º–æ–ø—Å", taps_required: 2000000, emoji: "‚ö°", bonus: { type: "energy_regen", value: -2 }, theme: "eternal"},
            {id: 12, name: "–ú–æ–ø—Å –°–æ–∑–¥–∞—Ç–µ–ª—å", taps_required: 5000000, emoji: "üéÆ", bonus: { type: "tap_power", value: 0.3 }, theme: "creator"},
            {id: 13, name: "–ú–æ–ø—Å –ü–æ–≤–µ–ª–∏—Ç–µ–ª—å", taps_required: 10000000, emoji: "üëÅ‚Äçüó®", bonus: { type: "coin_multiplier", value: 1.3 }, theme: "overlord"},
            {id: 14, name: "–ú–æ–ø—Å –ò–º–ø–µ—Ä–∞—Ç–æ—Ä", taps_required: 20000000, emoji: "ü´Ö", bonus: { type: "critical_chance", value: 5 }, theme: "imperial"},
            {id: 15, name: "–ú–æ–ø—Å –§–µ–Ω–∏–∫—Å", taps_required: 35000000, emoji: "ü¶Ö", bonus: { type: "energy_capacity", value: 50 }, theme: "phoenix"},
            {id: 16, name: "–ú–æ–ø—Å –î—Ä–∞–∫–æ–Ω", taps_required: 50000000, emoji: "üêâ", bonus: { type: "all_stats", value: 0.15 }, theme: "dragon"},
            {id: 17, name: "–ú–æ–ø—Å –¢–∏—Ç–∞–Ω", taps_required: 75000000, emoji: "üóø", bonus: { type: "tap_power", value: 0.4 }, theme: "titan"},
            {id: 18, name: "–ú–æ–ø—Å –ö–æ–ª–æ—Å—Å", taps_required: 100000000, emoji: "üèõ", bonus: { type: "critical_multiplier", value: 0.3 }, theme: "colossus"},
            {id: 19, name: "–ú–æ–ø—Å –í–ª–∞—Å—Ç–µ–ª–∏–Ω", taps_required: 150000000, emoji: "ü¶π", bonus: { type: "coin_multiplier", value: 1.4 }, theme: "master"},
            {id: 20, name: "–ú–æ–ø—Å –ú–µ—Ä–∫—É—Ä–∏–π", taps_required: 200000000, emoji: "‚òø", bonus: { type: "energy_regen", value: -3 }, theme: "mercury"},
            {id: 21, name: "–ú–æ–ø—Å –í–µ–Ω–µ—Ä–∞", taps_required: 250000000, emoji: "‚ôÄ", bonus: { type: "tap_power", value: 0.5 }, theme: "venus"},
            {id: 22, name: "–ú–æ–ø—Å –ú–∞—Ä—Å", taps_required: 300000000, emoji: "‚ôÇ", bonus: { type: "critical_chance", value: 8 }, theme: "mars"},
            {id: 23, name: "–ú–æ–ø—Å –Æ–ø–∏—Ç–µ—Ä", taps_required: 400000000, emoji: "‚ôÉ", bonus: { type: "energy_capacity", value: 100 }, theme: "jupiter"},
            {id: 24, name: "–ú–æ–ø—Å –°–∞—Ç—É—Ä–Ω", taps_required: 500000000, emoji: "‚ôÑ", bonus: { type: "all_stats", value: 0.2 }, theme: "saturn"},
            {id: 25, name: "–ú–æ–ø—Å –£—Ä–∞–Ω", taps_required: 650000000, emoji: "‚ôÖ", bonus: { type: "coin_multiplier", value: 1.5 }, theme: "uranus"},
            {id: 26, name: "–ú–æ–ø—Å –ù–µ–ø—Ç—É–Ω", taps_required: 800000000, emoji: "‚ôÜ", bonus: { type: "tap_power", value: 0.6 }, theme: "neptune"},
            {id: 27, name: "–ú–æ–ø—Å –ü–ª—É—Ç–æ–Ω", taps_required: 1000000000, emoji: "‚ôá", bonus: { type: "critical_multiplier", value: 0.4 }, theme: "pluto"},
            {id: 28, name: "–ú–æ–ø—Å –ó–≤–µ–∑–¥–Ω—ã–π", taps_required: 1300000000, emoji: "üå†", bonus: { type: "energy_regen", value: -4 }, theme: "stellar"},
            {id: 29, name: "–ú–æ–ø—Å –°–≤–µ—Ä—Ö–Ω–æ–≤—ã–π", taps_required: 1700000000, emoji: "üí´", bonus: { type: "all_stats", value: 0.25 }, theme: "supernova"},
            {id: 30, name: "–ú–æ–ø—Å –ì—Ä–∞–≤–∏—Ç–æ–Ω", taps_required: 2200000000, emoji: "üåÄ", bonus: { type: "coin_multiplier", value: 1.6 }, theme: "graviton"},
            {id: 31, name: "–ú–æ–ø—Å –ö–≤–∞–Ω—Ç–æ–≤—ã–π", taps_required: 3000000000, emoji: "üî¨", bonus: { type: "tap_power", value: 0.7 }, theme: "quantum"},
            {id: 32, name: "–ú–æ–ø—Å –†–µ–ª—è—Ç–∏–≤–∏—Å—Ç—Å–∫–∏–π", taps_required: 4000000000, emoji: "‚è≥", bonus: { type: "critical_chance", value: 10 }, theme: "relativistic"},
            {id: 33, name: "–ú–æ–ø—Å –°–∏–Ω–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å", taps_required: 5500000000, emoji: "‚ö´", bonus: { type: "energy_capacity", value: 200 }, theme: "singularity"},
            {id: 34, name: "–ú–æ–ø—Å –ú—É–ª—å—Ç–∏–≤—Å–µ–ª–µ–Ω–Ω–∞—è", taps_required: 7500000000, emoji: "üåå", bonus: { type: "all_stats", value: 0.3 }, theme: "multiverse"},
            {id: 35, name: "–ú–æ–ø—Å –ê–±—Å–æ–ª—é—Ç", taps_required: 10000000000, emoji: "üîÆ", bonus: { type: "coin_multiplier", value: 1.7 }, theme: "absolute"},
            {id: 36, name: "–ú–æ–ø—Å –ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å", taps_required: 15000000000, emoji: "‚ôæÔ∏è", bonus: { type: "tap_power", value: 0.8 }, theme: "infinity"},
            {id: 37, name: "–ú–æ–ø—Å –í–µ—á–Ω–æ—Å—Ç—å", taps_required: 25000000000, emoji: "‚åõ", bonus: { type: "critical_multiplier", value: 0.5 }, theme: "eternity"},
            {id: 38, name: "–ú–æ–ø—Å –ë–µ–∑–¥–Ω–∞", taps_required: 40000000000, emoji: "üï≥Ô∏è", bonus: { type: "energy_regen", value: -5 }, theme: "abyss"},
            {id: 39, name: "–ú–æ–ø—Å –û–±—Å–∏–¥–∏–∞–Ω–æ–≤—ã–π", taps_required: 60000000000, emoji: "ü™®", bonus: { type: "all_stats", value: 0.35 }, theme: "obsidian"},
            {id: 40, name: "–ú–æ–ø—Å –ö–∏–±–µ—Ä–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π", taps_required: 90000000000, emoji: "ü§ñ", bonus: { type: "coin_multiplier", value: 1.8 }, theme: "cybernetic"},
            {id: 41, name: "–ú–æ–ø—Å –ù–µ–π—Ä–æ–Ω–Ω—ã–π", taps_required: 130000000000, emoji: "üß†", bonus: { type: "tap_power", value: 0.9 }, theme: "neural"},
            {id: 42, name: "–ú–æ–ø—Å –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π", taps_required: 200000000000, emoji: "üñ•Ô∏è", bonus: { type: "critical_chance", value: 12 }, theme: "virtual"},
            {id: 43, name: "–ú–æ–ø—Å –•–∞–∫–µ—Ä", taps_required: 300000000000, emoji: "üíª", bonus: { type: "energy_capacity", value: 300 }, theme: "hacker"},
            {id: 44, name: "–ú–æ–ø—Å –ö—Ä–∏–ø—Ç–æ", taps_required: 450000000000, emoji: "‚Çø", bonus: { type: "all_stats", value: 0.4 }, theme: "crypto"},
            {id: 45, name: "–ú–æ–ø—Å –ë–ª–æ–∫—á–µ–π–Ω", taps_required: 700000000000, emoji: "‚õìÔ∏è", bonus: { type: "coin_multiplier", value: 1.9 }, theme: "blockchain"},
            {id: 46, name: "–ú–æ–ø—Å NFT", taps_required: 1000000000000, emoji: "üñºÔ∏è", bonus: { type: "tap_power", value: 1.0 }, theme: "nft"},
            {id: 47, name: "–ú–æ–ø—Å –ú–µ—Ç–∞–≤—Å–µ–ª–µ–Ω–Ω–∞—è", taps_required: 1500000000000, emoji: "üåê", bonus: { type: "critical_multiplier", value: 0.6 }, theme: "metaverse"},
            {id: 48, name: "–ú–æ–ø—Å –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç", taps_required: 2500000000000, emoji: "üß†", bonus: { type: "all_stats", value: 0.45 }, theme: "ai"},
            {id: 49, name: "–ú–æ–ø—Å –¢–µ—Ä–º–∏–Ω–∞—Ç–æ—Ä", taps_required: 4000000000000, emoji: "ü¶æ", bonus: { type: "energy_regen", value: -6 }, theme: "terminator"},
            {id: 50, name: "–ú–æ–ø—Å –ú–∞—Ç—Ä–∏—Ü–∞", taps_required: 7000000000000, emoji: "üìü", bonus: { type: "coin_multiplier", value: 2.0 }, theme: "matrix"},
            {id: 51, name: "–ú–æ–ø—Å –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä", taps_required: 12000000000000, emoji: "üèóÔ∏è", bonus: { type: "tap_power", value: 1.2 }, theme: "architect"},
            {id: 52, name: "–ú–æ–ø—Å –ë–æ–≥", taps_required: 20000000000000, emoji: "üëÅÔ∏è", bonus: { type: "all_stats", value: 0.5 }, theme: "god"}
        ];

        const UPGRADES = {
            tap_power: {name: "üí™ –°–∏–ª–∞ —Ç–∞–ø–∞", description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –º–æ–Ω–µ—Ç—ã –∑–∞ –∫–ª–∏–∫", base_cost: 50, cost_multiplier: 1.5, effect: 1, max_level: 100},
            energy_capacity: {name: "‚ö° –Å–º–∫–æ—Å—Ç—å —ç–Ω–µ—Ä–≥–∏–∏", description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —ç–Ω–µ—Ä–≥–∏—é", base_cost: 100, cost_multiplier: 2.0, effect: 10, max_level: 50},
            energy_regen: {name: "üîã –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è", description: "–£—Å–∫–æ—Ä—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏", base_cost: 200, cost_multiplier: 2.5, effect: -1, max_level: 30},
            critical_chance: {name: "üéØ –®–∞–Ω—Å –∫—Ä–∏—Ç–∞", description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —à–∞–Ω—Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞—Ä–∞", base_cost: 300, cost_multiplier: 3.0, effect: 0.5, max_level: 40},
            critical_multiplier: {name: "üí• –ú–Ω–æ–∂–∏—Ç–µ–ª—å –∫—Ä–∏—Ç–∞", description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –º–Ω–æ–∂–∏—Ç–µ–ª—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞—Ä–∞", base_cost: 500, cost_multiplier: 4.0, effect: 0.1, max_level: 25},
            auto_tapper: {name: "ü§ñ –ê–≤—Ç–æ-—Ç–∞–ø–ø–µ—Ä", description: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç–∞–ø–∞–µ—Ç –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥", base_cost: 1000, cost_multiplier: 5.0, effect: 1, max_level: 20}
        };

        let userData = {
            coins: 0,
            per_tap: 1,
            energy: 100,
            max_energy: 100,
            energy_regen_speed: 10,
            level: 1,
            total_taps: 0,
            upgrades: {},
            pug_skin: 1,
            referrals_count: 0,
            referral_bonus_claimed: false,
            referrer_id: null,
            clan_id: null,
            last_tap_time: new Date().toISOString(),
            last_energy_update: new Date().toISOString(),
            created_at: new Date().toISOString(),
            settings: {
                sound: true,
                vibration: true,
                darkMode: false,
                notifications: true,
                interfaceStyle: "default"
            },
            skin_bonuses: {}
        };

        let tg = window.Telegram.WebApp;
        let userId = null;
        let allUsers = [];
        let allClans = [];
        let allReferrals = [];
        let currentInterfaceStyle = "default";
        let skinBonusMultiplier = 1;
        let activeSkinTheme = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebApp Telegram
        if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
            tg.expand();
            tg.enableClosingConfirmation();
            userId = tg.initDataUnsafe.user.id.toString();
        } else {
            userId = 'local_user_' + Math.floor(Math.random() * 1000000);
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º–∞–º–∏
        function createSnowflakes() {
            const snowflakeCount = 30;
            for (let i = 0; i < snowflakeCount; i++) {
                setTimeout(() => {
                    const snowflake = document.createElement('div');
                    snowflake.className = 'snowflake';
                    snowflake.innerHTML = '‚ùÑÔ∏è';
                    snowflake.style.left = Math.random() * 100 + 'vw';
                    snowflake.style.animationDuration = (Math.random() * 10 + 10) + 's';
                    snowflake.style.opacity = Math.random() * 0.5 + 0.3;
                    snowflake.style.fontSize = (Math.random() * 10 + 10) + 'px';
                    document.body.appendChild(snowflake);
                    
                    setTimeout(() => {
                        if (snowflake.parentNode) {
                            snowflake.remove();
                        }
                    }, 30000);
                }, i * 300);
            }
        }

        function createBats() {
            const batCount = 5;
            for (let i = 0; i < batCount; i++) {
                const bat = document.createElement('div');
                bat.className = 'bat';
                bat.innerHTML = 'ü¶á';
                bat.style.left = Math.random() * 100 + 'vw';
                bat.style.top = Math.random() * 100 + 'vh';
                bat.style.animationDelay = (Math.random() * 5) + 's';
                bat.style.animationDuration = (Math.random() * 10 + 15) + 's';
                document.body.appendChild(bat);
            }
        }

        function createPumpkinTracker() {
            const pumpkin = document.createElement('div');
            pumpkin.className = 'pumpkin-tracker';
            pumpkin.id = 'pumpkin-tracker';
            document.body.appendChild(pumpkin);
            
            document.addEventListener('mousemove', (e) => {
                pumpkin.style.left = (e.clientX - 30) + 'px';
                pumpkin.style.top = (e.clientY - 30) + 'px';
            });
            
            document.addEventListener('touchmove', (e) => {
                if (e.touches[0]) {
                    pumpkin.style.left = (e.touches[0].clientX - 30) + 'px';
                    pumpkin.style.top = (e.touches[0].clientY - 30) + 'px';
                }
            });
        }

        function clearThemeEffects() {
            // –£–¥–∞–ª—è–µ–º —Å–Ω–µ–∂–∏–Ω–∫–∏
            document.querySelectorAll('.snowflake').forEach(el => el.remove());
            // –£–¥–∞–ª—è–µ–º –ª–µ—Ç—É—á–∏—Ö –º—ã—à–µ–π
            document.querySelectorAll('.bat').forEach(el => el.remove());
            // –£–¥–∞–ª—è–µ–º —Ç—ã–∫–≤—É
            document.getElementById('pumpkin-tracker')?.remove();
        }

        function applyInterfaceStyle(style) {
            clearThemeEffects();
            document.body.className = '';
            
            if (style === 'newyear') {
                document.body.classList.add('theme-newyear');
                createSnowflakes();
                setInterval(createSnowflakes, 30000);
            } else if (style === 'halloween') {
                document.body.classList.add('theme-halloween');
                createBats();
                createPumpkinTracker();
            } else if (style === 'classic') {
                document.body.classList.add('theme-classic');
            } else if (style === 'modern') {
                document.body.classList.add('theme-modern');
            }
            
            currentInterfaceStyle = style;
        }

        function applySkinTheme(skin) {
            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é —Ç–µ–º—É —Å–∫–∏–Ω–∞
            document.body.classList.remove('skin-theme-active');
            activeSkinTheme = null;
            
            // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ —Å–µ–∑–æ–Ω–Ω–∞—è —Ç–µ–º–∞, –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É —Å–∫–∏–Ω–∞
            if (currentInterfaceStyle === 'newyear' || currentInterfaceStyle === 'halloween') {
                return;
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É —Å–∫–∏–Ω–∞
            if (skin.theme && skin.theme !== 'default') {
                document.body.classList.add('skin-theme-active');
                document.body.classList.add(`skin-theme-${skin.theme}`);
                activeSkinTheme = skin.theme;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏
        function restoreEnergyBasedOnTime(userData) {
            try {
                const now = new Date();
                const lastUpdate = new Date(userData.last_energy_update);
                
                if (isNaN(lastUpdate.getTime())) {
                    return {
                        ...userData,
                        last_energy_update: now.toISOString()
                    };
                }
                
                const timeDiff = (now - lastUpdate) / 1000;
                
                if (timeDiff <= 0) {
                    return userData;
                }
                
                const energyRegenSpeed = userData.energy_regen_speed || 10;
                const currentEnergy = userData.energy || 0;
                const maxEnergy = userData.max_energy || 100;
                
                const energyToAdd = Math.floor(timeDiff / energyRegenSpeed);
                
                if (energyToAdd > 0) {
                    const newEnergy = Math.min(maxEnergy, currentEnergy + energyToAdd);
                    const usedTime = energyToAdd * energyRegenSpeed;
                    const newLastUpdate = new Date(lastUpdate.getTime() + usedTime * 1000);
                    
                    return {
                        ...userData,
                        energy: newEnergy,
                        last_energy_update: newLastUpdate.toISOString()
                    };
                }
                
                return userData;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏:', error);
                return userData;
            }
        }

        // –£–ª—É—á—à–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
        async function loadUserData() {
            try {
                console.log('üîç –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
                const response = await fetch(JSONBIN_URL, {
                    headers: {
                        "X-Master-Key": JSONBIN_API_KEY
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${response.status}`);
                }
                
                const data = await response.json();
                const users = data.record.users || {};
                const clans = data.record.clans || {};
                const referrals = data.record.referrals || {};
                
                allUsers = users;
                allClans = clans;
                allReferrals = referrals;
                
                if (users[userId]) {
                    console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ');
                    let savedData = users[userId];
                    
                    savedData = restoreEnergyBasedOnTime(savedData);
                    
                    if (typeof savedData.upgrades === 'string') {
                        try {
                            savedData.upgrades = JSON.parse(savedData.upgrades);
                        } catch (e) {
                            savedData.upgrades = {};
                        }
                    }
                    
                    userData = { 
                        ...userData, 
                        ...savedData,
                        settings: {
                            ...userData.settings,
                            ...(savedData.settings || {})
                        }
                    };
                    
                } else {
                    console.log('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ');
                    userData.last_energy_update = new Date().toISOString();
                    await saveUserData();
                }
                
                updateDisplay();
                applySettings();
                loadWithdrawRates();
                updateExchangeDisplay();
                document.getElementById('loading-overlay').style.display = 'none';
                updateSyncIndicator(false);
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                document.getElementById('loading-overlay').style.display = 'none';
                showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è.', 'error');
                updateSyncIndicator(false);
            }
        }

        async function saveUserData() {
            try {
                updateSyncIndicator(true);
                
                const response = await fetch(JSONBIN_URL, {
                    headers: {
                        "X-Master-Key": JSONBIN_API_KEY
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${response.status}`);
                }
                
                const data = await response.json();
                const users = data.record.users || {};
                
                const userDataToSave = {
                    username: userData.username || `user_${userId}`,
                    first_name: userData.first_name || "",
                    last_name: userData.last_name || "",
                    coins: userData.coins || 0,
                    per_tap: userData.per_tap || 1,
                    energy: userData.energy || 100,
                    max_energy: userData.max_energy || 100,
                    energy_regen_speed: userData.energy_regen_speed || 10,
                    last_tap_time: userData.last_tap_time || new Date().toISOString(),
                    level: userData.level || 1,
                    total_taps: userData.total_taps || 0,
                    last_energy_update: userData.last_energy_update || new Date().toISOString(),
                    upgrades: JSON.stringify(userData.upgrades || {}),
                    referrals_count: userData.referrals_count || 0,
                    referral_bonus_claimed: userData.referral_bonus_claimed || false,
                    referrer_id: userData.referrer_id || null,
                    clan_id: userData.clan_id || null,
                    pug_skin: userData.pug_skin || 1,
                    skin_bonuses: userData.skin_bonuses || {},
                    created_at: userData.created_at || new Date().toISOString(),
                    settings: userData.settings || {
                        sound: true,
                        vibration: true,
                        darkMode: false,
                        notifications: true,
                        interfaceStyle: "default"
                    }
                };
                
                users[userId] = userDataToSave;
                
                const updateResponse = await fetch(JSONBIN_UPDATE_URL, {
                    method: 'PUT',
                    headers: {
                        "X-Master-Key": JSONBIN_API_KEY,
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        ...data.record,
                        users: users
                    })
                });
                
                if (!updateResponse.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${updateResponse.status}`);
                }
                
                console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                updateSyncIndicator(false);
                showNotification('–î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã', 'success');
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
                showNotification('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏.', 'error');
                updateSyncIndicator(false);
            }
        }

        function updateSyncIndicator(syncing) {
            const indicator = document.getElementById('sync-indicator');
            if (syncing) {
                indicator.classList.add('syncing');
                indicator.querySelector('span').textContent = '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...';
            } else {
                indicator.classList.remove('syncing');
                indicator.querySelector('span').textContent = '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ';
                setTimeout(() => {
                    indicator.style.opacity = '0';
                    setTimeout(() => indicator.style.display = 'none', 300);
                }, 2000);
            }
        }

        function updateDisplay() {
            document.getElementById('coins').textContent = Math.floor(userData.coins).toLocaleString();
            document.getElementById('level').textContent = userData.level;
            document.getElementById('per-tap').textContent = userData.per_tap.toFixed(1);
            document.getElementById('energy').textContent = Math.floor(userData.energy);
            document.getElementById('max-energy').textContent = userData.max_energy;
            document.getElementById('regen-speed').textContent = userData.energy_regen_speed;
            document.getElementById('energy-fill').style.width = (userData.energy / userData.max_energy * 100) + '%';
            document.getElementById('withdraw-balance').textContent = Math.floor(userData.coins).toLocaleString();
            document.getElementById('total-taps').textContent = userData.total_taps.toLocaleString();
            document.getElementById('total-taps-count').textContent = userData.total_taps.toLocaleString();
            document.getElementById('total-taps-display').textContent = userData.total_taps.toLocaleString();
            document.getElementById('referrals-count').textContent = userData.referrals_count;
            document.getElementById('referrals-earned').textContent = (userData.referrals_count * 500).toLocaleString();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∞–Ω–µ
            if (userData.clan_id && allClans[userData.clan_id]) {
                const clan = allClans[userData.clan_id];
                document.getElementById('user-clan').textContent = clan.name;
            } else {
                document.getElementById('user-clan').textContent = "–ù–µ –≤ –∫–ª–∞–Ω–µ";
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∫–∏–Ω –∏ –±–æ–Ω—É—Å—ã
            const currentSkin = getCurrentSkin();
            document.getElementById('current-skin').textContent = currentSkin.emoji;
            document.getElementById('skin-name').textContent = currentSkin.name;
            document.getElementById('tap-area').innerHTML = currentSkin.emoji;
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É —Å–∫–∏–Ω–∞
            applySkinTheme(currentSkin);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–æ–Ω—É—Å —Å–∫–∏–Ω–∞
            const bonusElement = document.getElementById('skin-bonus');
            const bonus = getSkinBonus(currentSkin);
            if (bonus.value > 0) {
                bonusElement.style.display = 'block';
                bonusElement.textContent = `+${(bonus.value * 100)}%`;
                bonusElement.title = `–ë–æ–Ω—É—Å: ${getBonusDescription(bonus)}`;
            } else {
                bonusElement.style.display = 'none';
            }
            
            const nextSkin = getNextSkin();
            if (nextSkin) {
                document.getElementById('next-skin').textContent = `–°–ª–µ–¥—É—é—â–∏–π —Å–∫–∏–Ω: ${nextSkin.taps_required.toLocaleString()} —Ç–∞–ø–æ–≤`;
            } else {
                document.getElementById('next-skin').textContent = '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å–∫–∏–Ω unlocked!';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
            const refProgress5 = Math.min(100, (userData.referrals_count / 5) * 100);
            const refProgress10 = Math.min(100, (userData.referrals_count / 10) * 100);
            document.getElementById('ref-progress-5').style.width = `${refProgress5}%`;
            document.getElementById('ref-progress-10').style.width = `${refProgress10}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É (–∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –±–æ—Ç–∞)
            const refLink = `https://t.me/${BOT_USERNAME}?start=ref_${userId}`;
            document.getElementById('referral-code').textContent = refLink;
        }

        function getBonusDescription(bonus) {
            switch(bonus.type) {
                case 'tap_power': return `–°–∏–ª–∞ —Ç–∞–ø–∞ +${(bonus.value * 100)}%`;
                case 'coin_multiplier': return `–ú–æ–Ω–µ—Ç—ã x${bonus.value.toFixed(1)}`;
                case 'energy_regen': return `–†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏ +${Math.abs(bonus.value)} —Å–µ–∫`;
                case 'energy_capacity': return `–ú–∞–∫—Å. —ç–Ω–µ—Ä–≥–∏—è +${bonus.value}`;
                case 'critical_chance': return `–®–∞–Ω—Å –∫—Ä–∏—Ç–∞ +${bonus.value}%`;
                case 'critical_multiplier': return `–ú–Ω–æ–∂–∏—Ç–µ–ª—å –∫—Ä–∏—Ç–∞ +${bonus.value}`;
                case 'all_stats': return `–í—Å–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ +${(bonus.value * 100)}%`;
                default: return `–ë–æ–Ω—É—Å +${(bonus.value * 100)}%`;
            }
        }

        function applySettings() {
            const settings = userData.settings || {};
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            if (settings.interfaceStyle) {
                document.getElementById('interface-style').value = settings.interfaceStyle;
                applyInterfaceStyle(settings.interfaceStyle);
            }
            
            if (settings.darkMode) {
                document.body.classList.add('dark-mode');
            } else {
                document.body.classList.remove('dark-mode');
            }
            
            document.getElementById('sound-toggle').checked = settings.sound !== false;
            document.getElementById('vibration-toggle').checked = settings.vibration !== false;
            document.getElementById('dark-mode-toggle').checked = settings.darkMode === true;
            document.getElementById('notifications-toggle').checked = settings.notifications !== false;
        }

        function changeInterfaceStyle(style) {
            userData.settings.interfaceStyle = style;
            applyInterfaceStyle(style);
            applySkinTheme(getCurrentSkin()); // –ü–µ—Ä–µ–ø—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É —Å–∫–∏–Ω–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            saveUserData();
            showNotification('–°—Ç–∏–ª—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏–∑–º–µ–Ω–µ–Ω', 'success');
        }

        // –°–∏—Å—Ç–µ–º–∞ —Å–∫–∏–Ω–æ–≤ —Å –±–æ–Ω—É—Å–∞–º–∏
        function getCurrentSkin() {
            return PUG_SKINS.find(skin => skin.id === userData.pug_skin) || PUG_SKINS[0];
        }

        function getNextSkin() {
            const currentIndex = PUG_SKINS.findIndex(skin => skin.id === userData.pug_skin);
            return PUG_SKINS[currentIndex + 1];
        }

        function getSkinBonus(skin) {
            return skin.bonus || { type: 'none', value: 0 };
        }

        function applySkinBonus(skin) {
            const bonus = getSkinBonus(skin);
            skinBonusMultiplier = 1;
            
            if (bonus.type === 'coin_multiplier') {
                skinBonusMultiplier = bonus.value;
            } else if (bonus.type === 'all_stats') {
                skinBonusMultiplier = 1 + bonus.value;
            }
            
            return skinBonusMultiplier;
        }

        function checkSkinUnlocks() {
            const unlockedSkin = PUG_SKINS.filter(skin => userData.total_taps >= skin.taps_required)
                                         .reduce((max, skin) => skin.id > max.id ? skin : max, PUG_SKINS[0]);
            
            if (unlockedSkin.id > userData.pug_skin) {
                userData.pug_skin = unlockedSkin.id;
                showSkinUnlocked(unlockedSkin);
            }
        }

        function showSkinUnlocked(skin) {
            document.getElementById('popup-title').textContent = 'üéâ –ù–û–í–´–ô –°–ö–ò–ù!';
            const bonus = getSkinBonus(skin);
            const bonusText = bonus.value > 0 ? `\nüéÅ –ë–æ–Ω—É—Å: ${getBonusDescription(bonus)}` : '';
            document.getElementById('popup-message').textContent = `–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: ${skin.emoji} ${skin.name}${bonusText}`;
            document.getElementById('bonus-popup').className = 'bonus-popup skin-unlocked';
            document.getElementById('bonus-popup').style.display = 'block';
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–∞–ø–æ–≤ —Å —É—á–µ—Ç–æ–º –±–æ–Ω—É—Å–æ–≤ —Å–∫–∏–Ω–∞
        async function handleTap(event) {
            userData = restoreEnergyBasedOnTime(userData);
            
            if (userData.energy >= 1) {
                let earned = userData.per_tap;
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –±–æ–Ω—É—Å —Å–∫–∏–Ω–∞
                const currentSkin = getCurrentSkin();
                const skinMultiplier = applySkinBonus(currentSkin);
                earned *= skinMultiplier;
                
                userData.coins += earned;
                userData.energy--;
                userData.total_taps++;
                userData.last_tap_time = new Date().toISOString();
                userData.last_energy_update = new Date().toISOString();
                
                createTapEffect(event, `+${Math.floor(earned)} üíé`);
                
                // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–¥–∞—Ä —Å —É—á–µ—Ç–æ–º –±–æ–Ω—É—Å–æ–≤ —Å–∫–∏–Ω–∞
                let critChance = 5 + (userData.upgrades.critical_chance || 0) * 0.5;
                const skinBonus = getSkinBonus(currentSkin);
                if (skinBonus.type === 'critical_chance') {
                    critChance += skinBonus.value;
                }
                
                if (Math.random() < critChance / 100) {
                    let critMultiplier = 2 + (userData.upgrades.critical_multiplier || 0) * 0.1;
                    if (skinBonus.type === 'critical_multiplier') {
                        critMultiplier += skinBonus.value;
                    }
                    let critBonus = Math.floor(earned * critMultiplier);
                    userData.coins += critBonus;
                    createTapEffect(event, `üí• –ö–†–ò–¢! +${critBonus}`);
                }
                
                if (Math.random() < 0.1) {
                    const bonus = Math.floor(Math.random() * 5 + 1) * userData.per_tap * skinMultiplier;
                    userData.coins += bonus;
                    createTapEffect(event, `üéâ +${bonus}!`);
                }
                
                const newLevel = Math.floor(userData.coins / 1000) + 1;
                if (newLevel > userData.level) {
                    userData.level = newLevel;
                    showLevelUp();
                }
                
                checkSkinUnlocks();
                updateDisplay();
                await saveUserData();
                
            } else {
                showNotification('–≠–Ω–µ—Ä–≥–∏—è –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å. –ü–æ–¥–æ–∂–¥–∏ –Ω–µ–º–Ω–æ–≥–æ!', 'error');
            }
        }

        function createTapEffect(event, text) {
            const effect = document.createElement('div');
            effect.className = 'tap-effect';
            effect.textContent = text;
            
            const rect = event.target.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            
            effect.style.left = x + 'px';
            effect.style.top = y + 'px';
            
            document.querySelector('.pug-container').appendChild(effect);
            
            setTimeout(() => {
                if (effect.parentNode) {
                    effect.remove();
                }
            }, 1000);
        }

        // –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–ª–∞–Ω–æ–≤
        async function loadClansData() {
            try {
                const response = await fetch(JSONBIN_URL, {
                    headers: {
                        "X-Master-Key": JSONBIN_API_KEY
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const clans = data.record.clans || {};
                    allClans = clans;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∞–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    if (userData.clan_id && clans[userData.clan_id]) {
                        const clan = clans[userData.clan_id];
                        document.getElementById('user-clan').textContent = clan.name;
                    }
                    
                    return clans;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª–∞–Ω–æ–≤:', error);
            }
            return {};
        }

        async function showClans() {
            const menu = document.getElementById('clans-menu');
            await loadClansData();
            updateClanDisplay();
            menu.style.display = 'block';
        }

        function updateClanDisplay() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∞–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (userData.clan_id && allClans[userData.clan_id]) {
                const clan = allClans[userData.clan_id];
                const myClanTab = document.getElementById('my-clan-info');
                myClanTab.innerHTML = `
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 15px;">${clan.name}</h3>
                        <div style="margin-bottom: 10px;">${clan.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</div>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 15px;">
                            <div class="stat-card">
                                <div>üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏</div>
                                <div class="stat-value">${clan.members ? clan.members.length : 0}/50</div>
                            </div>
                            <div class="stat-card">
                                <div>üëä –¢–∞–ø—ã –∫–ª–∞–Ω–∞</div>
                                <div class="stat-value">${(clan.total_taps || 0).toLocaleString()}</div>
                            </div>
                            <div class="stat-card">
                                <div>üèÜ –£—Ä–æ–≤–µ–Ω—å</div>
                                <div class="stat-value">${clan.level || 1}</div>
                            </div>
                            <div class="stat-card">
                                <div>üìä –†–µ–π—Ç–∏–Ω–≥</div>
                                <div class="stat-value">#${getClanRank(clan.id)}</div>
                            </div>
                        </div>
                        ${clan.channel_link ? `
                            <div style="margin-bottom: 15px;">
                                <strong>üì¢ –ö–∞–Ω–∞–ª:</strong>
                                <div><a href="${clan.channel_link}" target="_blank" style="color: var(--accent);">${clan.channel_link}</a></div>
                            </div>
                        ` : ''}
                        <button class="btn btn-danger" style="width: 100%;" onclick="leaveClan()">
                            <i class="fas fa-sign-out-alt"></i> –ü–æ–∫–∏–Ω—É—Ç—å –∫–ª–∞–Ω
                        </button>
                    </div>
                `;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∫–ª–∞–Ω–æ–≤
            updateClansList();
        }

        function getClanRank(clanId) {
            const clansArray = Object.entries(allClans)
                .filter(([id, clan]) => !clan.is_fake)
                .map(([id, clan]) => ({
                    id,
                    total_taps: clan.total_taps || 0
                }))
                .sort((a, b) => b.total_taps - a.total_taps);
            
            const index = clansArray.findIndex(clan => clan.id === clanId);
            return index >= 0 ? index + 1 : 'N/A';
        }

        function updateClansList() {
            const clansList = document.getElementById('clans-list');
            clansList.innerHTML = '';
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞—Å—Ç–æ—è—â–∏–µ –∫–ª–∞–Ω—ã
            const realClans = Object.entries(allClans)
                .filter(([id, clan]) => !clan.is_fake)
                .sort((a, b) => (b[1].total_taps || 0) - (a[1].total_taps || 0));
            
            if (realClans.length === 0) {
                clansList.innerHTML = '<div style="text-align: center; padding: 20px; opacity: 0.7;">–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–ª–∞–Ω–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</div>';
                return;
            }
            
            realClans.forEach(([id, clan]) => {
                const membersCount = clan.members ? clan.members.length : 0;
                const isMember = clan.members && clan.members.includes(userId);
                const clanCard = document.createElement('div');
                clanCard.className = 'clan-card';
                
                clanCard.innerHTML = `
                    <div class="clan-header">
                        <div>
                            <strong>${clan.name}</strong>
                            <div style="font-size: 12px; opacity: 0.8;">üë• ${membersCount}/50 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                        </div>
                        <div>
                            <span style="font-size: 12px; background: rgba(255,215,0,0.2); padding: 3px 8px; border-radius: 10px;">
                                üèÜ –£—Ä. ${clan.level || 1}
                            </span>
                        </div>
                    </div>
                    <div style="font-size: 14px; margin-bottom: 10px;">
                        ${clan.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-size: 12px; opacity: 0.8;">
                            üëä –¢–∞–ø—ã: ${(clan.total_taps || 0).toLocaleString()}
                        </div>
                        <button class="btn ${isMember ? 'btn-accent' : 'btn-primary'}" 
                                style="padding: 5px 15px; font-size: 12px;" 
                                onclick="${isMember ? 'showNotification(\'–í—ã —É–∂–µ –≤ —ç—Ç–æ–º –∫–ª–∞–Ω–µ!\', \'info\')' : `joinClan('${id}')`}">
                            ${isMember ? '‚úÖ –í—ã –≤ –∫–ª–∞–Ω–µ' : '–í—Å—Ç—É–ø–∏—Ç—å'}
                        </button>
                    </div>
                    ${clan.channel_link ? `
                        <div style="margin-top: 10px; font-size: 12px; opacity: 0.8;">
                            üì¢ –ö–∞–Ω–∞–ª: <a href="${clan.channel_link}" target="_blank" style="color: var(--accent);">${clan.channel_link}</a>
                        </div>
                    ` : ''}
                `;
                
                clansList.appendChild(clanCard);
            });
        }

        async function joinClan(clanId) {
            if (!allClans[clanId]) {
                showNotification('–ö–ª–∞–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            const clan = allClans[clanId];
            if (clan.members && clan.members.includes(userId)) {
                showNotification('–í—ã —É–∂–µ –≤ —ç—Ç–æ–º –∫–ª–∞–Ω–µ', 'info');
                return;
            }
            
            if (clan.members && clan.members.length >= 50) {
                showNotification('–ö–ª–∞–Ω –∑–∞–ø–æ–ª–Ω–µ–Ω', 'error');
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–ª–∞–Ω–∞
            if (!clan.members) clan.members = [];
            clan.members.push(userId);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            userData.clan_id = clanId;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            await saveClanData(clanId, clan);
            await saveUserData();
            
            showNotification(`–í—ã –≤—Å—Ç—É–ø–∏–ª–∏ –≤ –∫–ª–∞–Ω ${clan.name}!`, 'success');
            updateClanDisplay();
        }

        async function leaveClan() {
            if (!userData.clan_id) {
                showNotification('–í—ã –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ –∫–ª–∞–Ω–µ', 'error');
                return;
            }
            
            const clanId = userData.clan_id;
            const clan = allClans[clanId];
            
            if (clan && clan.members) {
                clan.members = clan.members.filter(member => member !== userId);
                if (clan.members.length === 0) {
                    // –£–¥–∞–ª—è–µ–º –ø—É—Å—Ç–æ–π –∫–ª–∞–Ω
                    delete allClans[clanId];
                }
            }
            
            userData.clan_id = null;
            
            await saveClanData(clanId, clan);
            await saveUserData();
            
            showNotification('–í—ã –ø–æ–∫–∏–Ω—É–ª–∏ –∫–ª–∞–Ω', 'success');
            updateClanDisplay();
        }

        async function saveClanData(clanId, clanData) {
            try {
                const response = await fetch(JSONBIN_URL, {
                    headers: {
                        "X-Master-Key": JSONBIN_API_KEY
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const clans = data.record.clans || {};
                    
                    if (clanData) {
                        clans[clanId] = clanData;
                    } else {
                        delete clans[clanId];
                    }
                    
                    const updateResponse = await fetch(JSONBIN_UPDATE_URL, {
                        method: 'PUT',
                        headers: {
                            "X-Master-Key": JSONBIN_API_KEY,
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            ...data.record,
                            clans: clans
                        })
                    });
                    
                    if (updateResponse.ok) {
                        allClans = clans;
                        return true;
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–ª–∞–Ω–∞:', error);
            }
            return false;
        }

        // –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
        async function showLeaderboard() {
            const menu = document.getElementById('leaderboard-menu');
            await updateLeaderboardData();
            menu.style.display = 'block';
        }

        async function updateLeaderboardData() {
            try {
                const response = await fetch(JSONBIN_URL, {
                    headers: {
                        "X-Master-Key": JSONBIN_API_KEY
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const users = data.record.users || {};
                    const clans = data.record.clans || {};
                    
                    allUsers = users;
                    allClans = clans;
                    
                    // –¢–æ–ø –ø–æ –º–æ–Ω–µ—Ç–∞–º
                    const topByCoins = Object.entries(users)
                        .map(([id, user]) => ({
                            id,
                            username: user.username || `–ò–≥—Ä–æ–∫ ${id}`,
                            first_name: user.first_name || "",
                            last_name: user.last_name || "",
                            coins: user.coins || 0,
                            level: user.level || 1,
                            total_taps: user.total_taps || 0,
                            isCurrent: id === userId
                        }))
                        .sort((a, b) => b.coins - a.coins)
                        .slice(0, 100);
                    
                    // –¢–æ–ø –ø–æ —Ç–∞–ø–∞–º
                    const topByTaps = Object.entries(users)
                        .map(([id, user]) => ({
                            id,
                            username: user.username || `–ò–≥—Ä–æ–∫ ${id}`,
                            first_name: user.first_name || "",
                            last_name: user.last_name || "",
                            total_taps: user.total_taps || 0,
                            coins: user.coins || 0,
                            level: user.level || 1,
                            isCurrent: id === userId
                        }))
                        .sort((a, b) => b.total_taps - a.total_taps)
                        .slice(0, 100);
                    
                    // –¢–æ–ø –∫–ª–∞–Ω–æ–≤ –ø–æ —Ç–∞–ø–∞–º (—Ç–æ–ª—å–∫–æ –Ω–∞—Å—Ç–æ—è—â–∏–µ)
                    const topClansByTaps = Object.entries(clans)
                        .filter(([id, clan]) => !clan.is_fake)
                        .map(([id, clan]) => ({
                            id,
                            name: clan.name || `–ö–ª–∞–Ω ${id}`,
                            total_taps: clan.total_taps || 0,
                            members: clan.members || [],
                            level: clan.level || 1,
                            description: clan.description || "",
                            isCurrent: clan.members && clan.members.includes(userId)
                        }))
                        .sort((a, b) => b.total_taps - a.total_taps)
                        .slice(0, 100);
                    
                    updateLeaderboardList('players', topByCoins, 'coins');
                    updateLeaderboardList('taps', topByTaps, 'total_taps');
                    updateClanLeaderboardList(topClansByTaps);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞:', error);
            }
        }

        function updateLeaderboardList(tabId, users, field) {
            const listId = tabId === 'players' ? 'leaderboard-list' : 
                          tabId === 'taps' ? 'taps-leaderboard' : 'clans-leaderboard';
            const list = document.getElementById(listId);
            list.innerHTML = '';
            
            users.forEach((user, index) => {
                const item = document.createElement('div');
                item.className = 'leaderboard-item';
                if (user.isCurrent) {
                    item.style.background = 'rgba(255,215,0,0.2)';
                    item.style.border = '1px solid rgba(255,215,0,0.5)';
                }
                
                let displayName = user.username;
                if (user.first_name) {
                    displayName = user.first_name;
                    if (user.last_name) {
                        displayName += ' ' + user.last_name;
                    }
                }
                
                const avatarColor = `hsl(${parseInt(user.id) % 360}, 70%, 60%)`;
                
                let displayValue;
                if (field === 'coins') {
                    displayValue = `${user.coins.toLocaleString()} üíé`;
                } else if (field === 'total_taps') {
                    displayValue = `${user.total_taps.toLocaleString()} üëä`;
                } else {
                    displayValue = user[field];
                }
                
                item.innerHTML = `
                    <div class="leaderboard-rank ${index < 3 ? 'top-' + (index + 1) : ''}">
                        ${index < 3 ? ['ü•á', 'ü•à', 'ü•â'][index] : index + 1}
                    </div>
                    <div class="top-user">
                        <div class="user-avatar" style="background: ${avatarColor}">
                            ${displayName.charAt(0).toUpperCase()}
                        </div>
                        <div class="leaderboard-user">
                            <div>${displayName}</div>
                            <div style="font-size: 12px; opacity: 0.8;">–£—Ä. ${user.level}</div>
                        </div>
                    </div>
                    <div class="leaderboard-score">${displayValue}</div>
                `;
                list.appendChild(item);
            });
        }

        function updateClanLeaderboardList(clans) {
            const list = document.getElementById('clans-leaderboard');
            list.innerHTML = '';
            
            clans.forEach((clan, index) => {
                const item = document.createElement('div');
                item.className = 'leaderboard-item';
                if (clan.isCurrent) {
                    item.style.background = 'rgba(255,215,0,0.2)';
                    item.style.border = '1px solid rgba(255,215,0,0.5)';
                }
                
                const membersCount = clan.members.length || 1;
                
                item.innerHTML = `
                    <div class="leaderboard-rank ${index < 3 ? 'top-' + (index + 1) : ''}">
                        ${index < 3 ? ['ü•á', 'ü•à', 'ü•â'][index] : index + 1}
                    </div>
                    <div class="top-user">
                        <div class="user-avatar">
                            ${clan.isCurrent ? 'üëë' : 'üë•'}
                        </div>
                        <div class="leaderboard-user">
                            <div>${clan.name} ${clan.isCurrent ? '(–í–∞—à –∫–ª–∞–Ω)' : ''}</div>
                            <div style="font-size: 12px; opacity: 0.8;">üë• ${membersCount} –∏–≥—Ä–æ–∫–æ–≤ | üèÜ –£—Ä. ${clan.level}</div>
                        </div>
                    </div>
                    <div class="leaderboard-score">${clan.total_taps.toLocaleString()} üëä</div>
                `;
                list.appendChild(item);
            });
        }

        // –°–∏—Å—Ç–µ–º–∞ —Å–∫–∏–Ω–æ–≤
        function showSkins() {
            const menu = document.getElementById('skins-menu');
            const grid = document.getElementById('skins-grid');
            grid.innerHTML = '';
            
            const currentSkin = getCurrentSkin();
            
            PUG_SKINS.forEach(skin => {
                const isUnlocked = userData.total_taps >= skin.taps_required;
                const isCurrent = skin.id === userData.pug_skin;
                const isNext = skin.id === userData.pug_skin + 1;
                const bonus = getSkinBonus(skin);
                
                const skinCard = document.createElement('div');
                skinCard.className = 'skin-card';
                if (!isUnlocked) skinCard.classList.add('locked');
                if (isCurrent) skinCard.classList.add('current');
                
                let bonusText = '';
                if (bonus.value > 0) {
                    bonusText = `<div style="font-size: 10px; color: var(--accent); margin-top: 5px;">
                        üéÅ ${getBonusDescription(bonus)}
                    </div>`;
                }
                
                skinCard.innerHTML = `
                    <div class="skin-emoji">${skin.emoji}</div>
                    <div class="skin-name">${skin.name}</div>
                    <div class="skin-requirement">${skin.taps_required.toLocaleString()} —Ç–∞–ø–æ–≤</div>
                    ${bonusText}
                    ${isCurrent ? '<div style="color: var(--accent); font-size: 10px;">–¢–µ–∫—É—â–∏–π</div>' : ''}
                    ${isNext ? '<div style="color: #00FF00; font-size: 10px;">–°–ª–µ–¥—É—é—â–∏–π</div>' : ''}
                `;
                
                if (isUnlocked && !isCurrent) {
                    skinCard.onclick = () => selectSkin(skin.id);
                } else if (!isUnlocked) {
                    skinCard.onclick = () => {
                        showNotification(`–ù—É–∂–Ω–æ ${skin.taps_required.toLocaleString()} —Ç–∞–ø–æ–≤ –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏`, 'error');
                    };
                }
                
                grid.appendChild(skinCard);
            });
            
            menu.style.display = 'block';
        }

        async function selectSkin(skinId) {
            const skin = PUG_SKINS.find(s => s.id === skinId);
            if (!skin) return;
            
            userData.pug_skin = skinId;
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É —Å–∫–∏–Ω–∞
            applySkinTheme(skin);
            
            await saveUserData();
            updateDisplay();
            showSkins();
            showNotification(`–°–∫–∏–Ω "${skin.name}" –ø—Ä–∏–º–µ–Ω–µ–Ω!`, 'success');
        }

        // –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
        function showReferrals() {
            const refLink = `https://t.me/${BOT_USERNAME}?start=ref_${userId}`;
            document.getElementById('referral-code').textContent = refLink;
            document.getElementById('referrals-menu').style.display = 'block';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
            updateReferralStats();
        }

        async function updateReferralStats() {
            try {
                const response = await fetch(JSONBIN_URL, {
                    headers: {
                        "X-Master-Key": JSONBIN_API_KEY
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const referrals = data.record.referrals || {};
                    
                    // –°—á–∏—Ç–∞–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    let referralCount = 0;
                    Object.values(referrals).forEach(ref => {
                        if (ref.referrer_id === userId) {
                            referralCount++;
                        }
                    });
                    
                    userData.referrals_count = referralCount;
                    updateDisplay();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:', error);
            }
        }

        function copyReferralCode() {
            const refLink = `https://t.me/${BOT_USERNAME}?start=ref_${userId}`;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(refLink).then(() => {
                    showNotification('–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
                });
            } else {
                const textArea = document.createElement('textarea');
                textArea.value = refLink;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function showLevelUp() {
            document.getElementById('popup-title').textContent = 'üéâ –£–†–û–í–ï–ù–¨ –ü–û–í–´–®–ï–ù!';
            document.getElementById('popup-message').textContent = `–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —É—Ä–æ–≤–Ω—è ${userData.level}`;
            document.getElementById('bonus-popup').className = 'bonus-popup level-up';
            document.getElementById('bonus-popup').style.display = 'block';
        }

        function closePopup() {
            document.getElementById('bonus-popup').style.display = 'none';
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notification-text');
            
            text.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –æ–∫–Ω–∞
        function handleResize() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            const pugContainer = document.querySelector('.pug-container');
            if (pugContainer) {
                const size = Math.min(280, window.innerWidth * 0.7, window.innerHeight * 0.4);
                pugContainer.style.width = `${size}px`;
                pugContainer.style.height = `${size}px`;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.getElementById('tap-area').addEventListener('click', handleTap);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        document.getElementById('crypto-amount').addEventListener('input', updateExchangeDisplay);
        document.getElementById('ewallet-amount').addEventListener('input', updateExchangeDisplay);
        document.getElementById('game-amount').addEventListener('input', updateExchangeDisplay);
        document.getElementById('crypto-method').addEventListener('change', updateExchangeDisplay);
        document.getElementById('ewallet-method').addEventListener('change', updateExchangeDisplay);
        document.getElementById('game-method').addEventListener('change', updateExchangeDisplay);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        document.getElementById('sound-toggle').addEventListener('change', async function() {
            userData.settings.sound = this.checked;
            await saveUserData();
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        });
        
        document.getElementById('vibration-toggle').addEventListener('change', async function() {
            userData.settings.vibration = this.checked;
            await saveUserData();
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        });
        
        document.getElementById('dark-mode-toggle').addEventListener('change', async function() {
            userData.settings.darkMode = this.checked;
            applySettings();
            await saveUserData();
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        });
        
        document.getElementById('notifications-toggle').addEventListener('change', async function() {
            userData.settings.notifications = this.checked;
            await saveUserData();
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        });
        
        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
        setInterval(() => {
            const oldEnergy = userData.energy;
            userData = restoreEnergyBasedOnTime(userData);
            if (userData.energy !== oldEnergy) {
                updateDisplay();
            }
        }, 1000);
        
        // –ê–≤—Ç–æ-—Ç–∞–ø–ø–µ—Ä
        setInterval(async () => {
            const autoTapperLevel = userData.upgrades.auto_tapper || 0;
            if (autoTapperLevel > 0) {
                userData = restoreEnergyBasedOnTime(userData);
                
                if (userData.energy > 0) {
                    const taps = Math.min(autoTapperLevel, userData.energy);
                    
                    for (let i = 0; i < taps; i++) {
                        let earned = userData.per_tap;
                        const currentSkin = getCurrentSkin();
                        const skinMultiplier = applySkinBonus(currentSkin);
                        earned *= skinMultiplier;
                        
                        userData.coins += earned;
                        userData.energy--;
                        userData.total_taps++;
                    }
                    
                    userData.last_energy_update = new Date().toISOString();
                    
                    updateDisplay();
                    await saveUserData();
                }
            }
        }, 10000);
        
        // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        setInterval(async () => {
            await loadUserData();
        }, 30000); // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', handleResize);
        window.addEventListener('orientationchange', handleResize);
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        loadUserData();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤
        setTimeout(handleResize, 100);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç Telegram
        if (tg) {
            tg.onEvent('viewportChanged', () => {
                tg.expand();
                setTimeout(handleResize, 100);
            });
        }

        // –§—É–Ω–∫—Ü–∏–∏ –º–µ–Ω—é (–æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        function hideUpgrades() { document.getElementById('upgrades-menu').style.display = 'none'; }
        function showUpgrades() { document.getElementById('upgrades-menu').style.display = 'block'; }
        function hideWithdraw() { document.getElementById('withdraw-menu').style.display = 'none'; }
        function showWithdraw() { 
            updateMinAmount('crypto');
            updateMinAmount('ewallet');
            updateMinAmount('game');
            document.getElementById('withdraw-menu').style.display = 'block'; 
        }
        function hideSkins() { document.getElementById('skins-menu').style.display = 'none'; }
        function hideLeaderboard() { document.getElementById('leaderboard-menu').style.display = 'none'; }
        function hideClans() { document.getElementById('clans-menu').style.display = 'none'; }
        function hideReferrals() { document.getElementById('referrals-menu').style.display = 'none'; }
        function hideSettings() { document.getElementById('settings-menu').style.display = 'none'; }
        function showSettings() { 
            document.getElementById('settings-menu').style.display = 'block'; 
        }
        
        function switchWithdrawTab(tab) {
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(tabEl => tabEl.classList.remove('active'));
            document.getElementById(`${tab}-tab`).classList.add('active');
            event.target.classList.add('active');
            if (tab === 'crypto') updateMinAmount('crypto');
            else if (tab === 'ewallet') updateMinAmount('ewallet');
            else if (tab === 'game') updateMinAmount('game');
        }
        
        function switchLeaderboardTab(tab) {
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(tabEl => tabEl.classList.remove('active'));
            document.getElementById(`${tab}-tab`).classList.add('active');
            event.target.classList.add('active');
        }
        
        function switchClanTab(tab) {
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(tabEl => tabEl.classList.remove('active'));
            document.getElementById(`clan-${tab}-tab`).classList.add('active');
            event.target.classList.add('active');
            if (tab === 'list') updateClansList();
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (loadWithdrawRates, updateMinAmount, updateExchangeDisplay, submitWithdraw –∏ —Ç.–¥.)
        // –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–æ–¥–µ
    </script>
</body>
</html>
